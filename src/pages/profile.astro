---
import BaseLayout from '../layouts/BaseLayout.astro';
import { User, Settings, Bell, Heart, ShoppingBag, TrendingUp, ChevronRight, LogOut } from 'lucide-react';

// Mock user data
const user = {
  id: 'user_123',
  name: 'ç”°ä¸­ å¤ªéƒ',
  email: 'tanaka@example.com',
  avatar: '/images/avatar-placeholder.jpg',
  memberSince: '2023-06-15',
  lastLogin: '2024-01-20T10:30:00Z',
  preferences: {
    notifications: {
      email: true,
      push: true,
      priceAlerts: true,
      restockAlerts: true,
      dealAlerts: true
    },
    currency: 'JPY',
    language: 'ja',
    favoritePlatforms: ['Amazon', 'æ¥½å¤©'],
    defaultSort: 'price_low'
  },
  stats: {
    totalSearched: 1247,
    alertsCreated: 23,
    savingsCalculated: 45780,
    productsCompared: 89
  }
};

const menuItems = [
  {
    icon: User,
    label: 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†',
    href: '/profile/edit',
    description: 'åå‰ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¤‰æ›´'
  },
  {
    icon: Bell,
    label: 'é€šçŸ¥è¨­å®š',
    href: '/profile/notifications',
    description: 'ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã€ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã®è¨­å®š'
  },
  {
    icon: Heart,
    label: 'ãŠæ°—ã«å…¥ã‚Š',
    href: '/profile/favorites',
    description: 'ãŠæ°—ã«å…¥ã‚Šè£½å“ãƒªã‚¹ãƒˆ'
  },
  {
    icon: ShoppingBag,
    label: 'è³¼å…¥å±¥æ­´',
    href: '/profile/history',
    description: 'éå»ã®è³¼å…¥è¨˜éŒ²'
  },
  {
    icon: TrendingUp,
    label: 'ä¾¡æ ¼è¿½è·¡',
    href: '/profile/tracking',
    description: 'ä¾¡æ ¼å¤‰å‹•ã®è¿½è·¡ã¨åˆ†æ'
  },
  {
    icon: Settings,
    label: 'è©³ç´°è¨­å®š',
    href: '/profile/settings',
    description: 'è¨€èªã€é€šè²¨ã€è¡¨ç¤ºè¨­å®š'
  }
];

const recentActivity = [
  {
    type: 'search',
    product: 'iPhone 15 Pro',
    timestamp: '2024-01-20T14:30:00Z',
    savings: null
  },
  {
    type: 'alert_triggered',
    product: 'Sony WH-1000XM5',
    timestamp: '2024-01-19T22:15:00Z',
    savings: 7100
  },
  {
    type: 'comparison',
    products: ['iPhone 15', 'iPhone 15 Pro', 'Samsung S24'],
    timestamp: '2024-01-19T10:45:00Z',
    savings: null
  },
  {
    type: 'alert_created',
    product: 'Nintendo Switch OLED',
    timestamp: '2024-01-18T16:20:00Z',
    savings: null
  }
];

const getActivityIcon = (type) => {
  switch (type) {
    case 'search': return 'ğŸ”';
    case 'alert_triggered': return 'ğŸ””';
    case 'comparison': return 'âš–ï¸';
    case 'alert_created': return 'â•';
    default: return 'ğŸ“';
  }
};

const getActivityText = (activity) => {
  switch (activity.type) {
    case 'search':
      return `${activity.product}ã‚’æ¤œç´¢`;
    case 'alert_triggered':
      return `${activity.product}ã®ä¾¡æ ¼ä¸‹è½é€šçŸ¥ (Â¥${activity.savings.toLocaleString()}ãŠå¾—)`;
    case 'comparison':
      return `${activity.products.length}è£½å“ã‚’æ¯”è¼ƒ`;
    case 'alert_created':
      return `${activity.product}ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ä½œæˆ`;
    default:
      return 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£';
  }
};
---

<BaseLayout
  title="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« - Yabaii"
  description="Yabaiiã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã€é€šçŸ¥ç®¡ç†ã€åˆ©ç”¨å±¥æ­´ã‚’ç¢ºèªã§ãã¾ã™ã€‚"
>
  <div class="container py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      {/* Sidebar - User Info */}
      <aside class="lg:col-span-1">
        <div class="bg-white rounded-lg shadow-md p-6">
          {/* Avatar Section */}
          <div class="text-center mb-6">
            <div class="w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center">
              <User class="w-12 h-12 text-gray-400" />
            </div>
            <h2 class="text-xl font-semibold text-gray-900">{user.name}</h2>
            <p class="text-gray-600">{user.email}</p>
            <div class="flex items-center justify-center text-sm text-gray-500 mt-2">
              <span>ãƒ¡ãƒ³ãƒãƒ¼ since {new Date(user.memberSince).toLocaleDateString('ja-JP')}</span>
            </div>
          </div>

          {/* Stats */}
          <div class="space-y-3 mb-6">
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">æ¤œç´¢å›æ•°</span>
              <span class="font-semibold text-gray-900">{user.stats.totalSearched.toLocaleString()}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">ä½œæˆã‚¢ãƒ©ãƒ¼ãƒˆ</span>
              <span class="font-semibold text-gray-900">{user.stats.alertsCreated}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">ç¯€ç´„é¡</span>
              <span class="font-semibold text-green-600">Â¥{user.stats.savingsCalculated.toLocaleString()}</span>
            </div>
            <div class="flex justify-between items-center py-2">
              <span class="text-sm text-gray-600">æ¯”è¼ƒè£½å“</span>
              <span class="font-semibold text-gray-900">{user.stats.productsCompared}</span>
            </div>
          </div>

          {/* Quick Actions */}
          <div class="space-y-2">
            <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center">
              <User class="w-4 h-4 mr-2" />
              ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
            </button>
            <button class="w-full px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors flex items-center justify-center">
              <LogOut class="w-4 h-4 mr-2" />
              ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
            </button>
          </div>
        </div>

        {/* Preferences Summary */}
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
          <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
            <Settings class="w-4 h-4 mr-2" />
            è¨­å®šæ¦‚è¦
          </h3>
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</span>
              <span class={`text-xs px-2 py-1 rounded-full ${user.preferences.notifications.email ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>
                {user.preferences.notifications.email ? 'ON' : 'OFF'}
              </span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥</span>
              <span class={`text-xs px-2 py-1 rounded-full ${user.preferences.notifications.push ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>
                {user.preferences.notifications.push ? 'ON' : 'OFF'}
              </span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">ä¾¡æ ¼ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
              <span class={`text-xs px-2 py-1 rounded-full ${user.preferences.notifications.priceAlerts ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>
                {user.preferences.notifications.priceAlerts ? 'ON' : 'OFF'}
              </span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">ãŠæ°—ã«å…¥ã‚Šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </span>
              <div class="flex space-x-1">
                {user.preferences.favoritePlatforms.map((platform) => (
                  <span key={platform} class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">
                    {platform}
                  </span>
                ))}
              </div>
            </div>
          </div>
        </div>
      </aside>

      {/* Main Content */}
      <main class="lg:col-span-2">
        {/* Menu Items */}
        <section class="mb-10">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {menuItems.map((item) => (
              <a
                key={item.href}
                href={item.href}
                class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow group"
              >
                <div class="flex items-start space-x-4">
                  <div class="p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors">
                    <item.icon class="w-6 h-6 text-blue-600" />
                  </div>
                  <div class="flex-1">
                    <h3 class="font-semibold text-gray-900 mb-1 group-hover:text-blue-600 transition-colors">
                      {item.label}
                    </h3>
                    <p class="text-sm text-gray-600 mb-3">{item.description}</p>
                    <div class="flex items-center text-blue-600 text-sm font-medium group-hover:text-blue-700">
                      <span>é–‹ã</span>
                      <ChevronRight class="w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform" />
                    </div>
                  </div>
                </div>
              </a>
            ))}
          </div>
        </section>

        {/* Recent Activity */}
        <section>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-gray-900">æœ€è¿‘ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</h2>
            <a href="/profile/activity" class="text-blue-600 hover:text-blue-700 text-sm font-medium">
              ã™ã¹ã¦è¦‹ã‚‹
            </a>
          </div>

          <div class="bg-white rounded-lg shadow-md">
            {recentActivity.length > 0 ? (
              <div class="divide-y divide-gray-200">
                {recentActivity.map((activity, index) => (
                  <div key={index} class="p-6 hover:bg-gray-50 transition-colors">
                    <div class="flex items-start space-x-4">
                      <div class="text-2xl">
                        {getActivityIcon(activity.type)}
                      </div>
                      <div class="flex-1">
                        <div class="flex items-center justify-between">
                          <h3 class="font-semibold text-gray-900">
                            {getActivityText(activity)}
                          </h3>
                          <span class="text-sm text-gray-500">
                            {new Date(activity.timestamp).toLocaleString('ja-JP')}
                          </span>
                        </div>
                        {activity.savings && (
                          <div class="mt-2 text-green-600 font-semibold">
                            ç¯€ç´„é¡: Â¥{activity.savings.toLocaleString()}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            ) : (
              <div class="p-12 text-center">
                <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒã‚ã‚Šã¾ã›ã‚“</h3>
                <p class="text-gray-600">
                  æ¤œç´¢ã‚„ä¾¡æ ¼æ¯”è¼ƒã‚’å§‹ã‚ã‚‹ã¨ã€ã“ã“ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
                </p>
              </div>
            )}
          </div>
        </section>

        {/* Savings Summary */}
        <section class="mt-10">
          <div class="bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-8 text-white text-center">
            <h3 class="text-2xl font-bold mb-4">ç¯€ç´„å®Ÿç¸¾</h3>
            <div class="text-4xl font-bold mb-2">
              Â¥{user.stats.savingsCalculated.toLocaleString()}
            </div>
            <p class="mb-6">
              Yabaiiã‚’åˆ©ç”¨ã—ã¦ç¯€ç´„ã—ãŸé‡‘é¡
            </p>
            <div class="grid grid-cols-3 gap-4 max-w-md mx-auto">
              <div class="text-center">
                <div class="text-2xl font-bold">{user.stats.alertsCreated}</div>
                <div class="text-sm opacity-90">ã‚¢ãƒ©ãƒ¼ãƒˆä½œæˆ</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold">{user.stats.productsCompared}</div>
                <div class="text-sm opacity-90">è£½å“æ¯”è¼ƒ</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold">{user.stats.totalSearched}</div>
                <div class="text-sm opacity-90">æ¤œç´¢å›æ•°</div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>
</BaseLayout>
